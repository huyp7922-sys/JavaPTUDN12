<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.*?>

<VBox xmlns="http://javafx.com/javafx/8.0.171"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.ptudn12.main.controller.StatisticsManagementController"
      stylesheets="@statistics-management-styles.css"
      spacing="20">
    
    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>
    
    <HBox alignment="CENTER_LEFT" spacing="15">
        <Label text="Thống kê chi tiết theo tuyến đường" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button text="Xuất PDF" onAction="#handleExportPDF" fx:id="btnExportPDF"/>
    </HBox>

    <TitledPane text="Bộ lọc tìm kiếm" animated="true" collapsible="true" expanded="false">
        <VBox spacing="10">
            <padding>
                <Insets top="10" right="10" bottom="10" left="10"/>
            </padding>
            <GridPane hgap="15" vgap="10">
                <Label text="Tên tuyến:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                <TextField fx:id="txtSearch" promptText="Nhập tên tuyến..." 
                           onKeyReleased="#handleSearch"
                           GridPane.columnIndex="1" GridPane.rowIndex="0" prefWidth="250"/>
                
                <Label text="Mã tuyến:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                <TextField fx:id="txtMaTuyen" promptText="Nhập mã tuyến..." 
                           onKeyReleased="#handleFilterByCode"
                           GridPane.columnIndex="1" GridPane.rowIndex="1" prefWidth="250"/>
                
                <Label text="Tỷ lệ lấp đầy tối thiểu (%):" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                <TextField fx:id="txtTiLe" promptText="Ví dụ: 50" 
                           onKeyReleased="#handleFilterByRatio"
                           GridPane.columnIndex="1" GridPane.rowIndex="2" prefWidth="250"/>

                <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="3" style="-fx-padding: 10 0 0 0;">
                    <Button text="Áp dụng" onAction="#handleApplyFilters" defaultButton="true" prefWidth="80"/>
                    <Button text="Làm mới" onAction="#handleResetFilters" prefWidth="80"/>
                </HBox>
            </GridPane>
        </VBox>
    </TitledPane>

    <TableView fx:id="tableStats" VBox.vgrow="ALWAYS">
        <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
        </columnResizePolicy>
        <columns>
            <TableColumn text="Mã tuyến" fx:id="colMaTuyen"/>
            <TableColumn text="Tên tuyến" fx:id="colTenTuyen"/>
            <TableColumn text="Tổng vé bán" fx:id="colTongVe"/>
            <TableColumn text="Tỷ lệ lấp đầy" fx:id="colTiLe"/>
            <TableColumn text="Số chuyến" fx:id="colSoChuyen"/>
            <TableColumn text="Doanh thu (VND)" fx:id="colDoanhThu"/>
        </columns>
    </TableView>
</VBox>