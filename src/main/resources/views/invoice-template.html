<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Hóa Đơn</title>
    <!-- Thẻ link này sẽ được OpenHTMLToPdf đọc để áp dụng CSS khi tạo file PDF -->
    <link rel="stylesheet" href="invoice-style.css" />
</head>
<body>
    <div class="invoice-container">
        <!-- HEADER DÙNG TABLE ĐỂ ĐẢM BẢO TƯƠNG THÍCH -->
        <table class="header-table">
            <tbody>
                <tr>
                    <td class="logo-cell">
                        <!--<img src="logo_placeholder.png" alt="Logo" class="logo-img"/> -->
                    </td>
                    <td class="title-cell">
                        <h1>HÓA ĐƠN GIÁ TRỊ GIA TĂNG</h1>
                        <p>Ngày <span th:text="${ngayLap}">...</span> tháng <span th:text="${thangLap}">...</span> năm <span th:text="${namLap}">...</span></p>
                    </td>
                    <td class="info-cell">
                        <p><strong>Ký hiệu:</strong> <span th:text="${kyHieu}">...</span></p>
                        <p><strong>Số:</strong> <span th:text="${soHD}">...</span></p>
                        <p><strong>ID:</strong> <span th:text="${idHD}">...</span></p>
                    </td>
                </tr>
            </tbody>
        </table>

        <section class="party-info">
            <p><strong>Đơn vị bán hàng:</strong> CÔNG TY CỔ PHẦN VẬN TẢI ĐƯỜNG SẮT HÀ NỘI</p>
            <div class="info-line"><p><strong>MST:</strong> 0100106264</p><p><strong>Điện thoại:</strong> (84-4) 39421117</p></div>
            <p><strong>Địa chỉ:</strong> Số nhà 130, đường Lê Duẩn, Phường Nguyễn Du, Quận Hai Bà Trưng, Thành phố Hà Nội, Việt Nam</p>
            <hr class="separator"/>
            <div class="info-line"><p><strong>Họ tên người mua hàng:</strong> <span th:text="${tenNguoiMua}">...</span></p><p><strong>Điện thoại:</strong> <span th:text="${sdtNguoiMua}">...</span></p></div>
            <p><strong>Tên đơn vị:</strong> <span th:text="${tenDonVi}">...</span></p>
            <p><strong>MST:</strong> <span th:text="${mstDonVi}">...</span></p>
            <p><strong>Địa chỉ:</strong> <span th:text="${diaChiDonVi}">...</span></p>
            <div class="info-line"><p><strong>Hình thức thanh toán:</strong> <span th:text="${hinhThucTT}">...</span></p><p><strong>Số tài khoản:</strong> <span th:text="${stkDonVi}">...</span></p></div>
        </section>

        <section class="items-table">
            <table>
                <thead>
                    <tr>
                        <th>STT</th><th>Mã vé</th><th>Tên dịch vụ</th><th>ĐVT</th><th>Số lượng</th><th>Đơn giá</th><th>Thành tiền</th><th>Thuế suất</th><th>Tiền thuế GTGT</th><th>TT có thuế</th>
                    </tr>
					<tr class="calculation-rule-row">
						<th>a</th><th>b</th><th>c</th><th>d</th><th>1</th><th>2</th><th>3=1x2</th><th>4</th><th>5=3x4</th><th>6=3+5</th>
					</tr>
                </thead>
				<tbody>
                    <!-- Lặp qua tất cả các loại hàng -->
                    <tr th:each="row : ${allItems}">
                        <!-- Hàng nội dung hoặc hàng trống -->
                        <th:block th:if="${row.type == 'ITEM'}">
                            <td class="text-center" th:text="${row.stt}">...</td>
                            <td th:text="${row.maVe}">...</td>
                            <td th:text="${row.tenDichVu}">...</td>
                            <td th:text="${row.dvt}">...</td>
                            <td class="text-right" th:text="${row.soLuong}">...</td>
                            <td class="text-right" th:text="${row.donGia}">...</td>
                            <td class="text-right" th:text="${row.thanhTien}">...</td>
                            <td class="text-center" th:text="${row.thueSuat}">...</td>
                            <td class="text-right" th:text="${row.tienThue}">...</td>
                            <td class="text-right" th:text="${row.tongCong}">...</td>
                        </th:block>

                        <!-- Hàng tổng kết theo thuế suất -->
                        <th:block th:if="${row.type == 'SUMMARY_BY_TAX'}">
                            <td class="no-border text-right" colspan="6" th:text="${row.description}">...</td>
                            <td class="text-right" th:text="${row.thanhTien}">...</td>
                            <td class="text-center" th:text="${row.thueSuat}">...</td>
                            <td class="text-right" th:text="${row.tienThue}">...</td>
                            <td class="text-right" th:text="${row.tongCong}">...</td>
                        </th:block>

                        <!-- Hàng tổng cộng cuối cùng -->
                        <th:block th:if="${row.type == 'FINAL_TOTAL'}">
                            <td class="no-border text-right strong" colspan="6" th:text="${row.description}">...</td>
                            <td class="text-right" th:text="${row.thanhTien}">...</td>
                            <td class="no-border"></td>
                            <td class="text-right" th:text="${row.tienThue}">...</td>
                            <td class="text-right strong" th:text="${row.tongCong}">...</td>
                        </th:block>
                    </tr>
                </tbody>
            </table>
        </section>
        <!--
		<section class="summary-section">
            <table>
                <tbody>
                    <tr th:each="summary : ${summariesByTax}">
                        <td class="no-border text-right" colspan="6" th:text="${summary.description}">Tổng theo từng loại thuế suất:</td>
                        <td class="text-right" th:text="${summary.thanhTien}">...</td>
                        <td class="text-center" th:text="${summary.thueSuat}">...</td>
                        <td class="text-right" th:text="${summary.tienThue}">...</td>
                        <td class="text-right" th:text="${summary.tongCong}">...</td>
                    </tr>
                    <tr>
                        <td class="no-border text-right strong" colspan="6">Tổng cộng:</td>
                        <td class="text-right strong" th:text="${tongTienHang}">...</td>
                        <td class="no-border"></td>
                        <td class="text-right strong" th:text="${tongTienThue}">...</td>
                        <td class="text-right strong" th:text="${tongThanhToan}">...</td>
                    </tr>
                </tbody>
            </table>
        </section>
		-->

		<section class="final-summary">
            <p><strong>Số tiền viết bằng chữ:</strong> <span th:text="${tongTienBangChu}">...</span></p>
            <p><strong>Ghi chú:</strong> .......................................................................................................................................................................</p>
        </section>
        
        <table class="signature-table">
            <tbody>
                <tr>
                    <td>
                        <p><strong>Người mua hàng</strong></p>
                        <p>(Ký, ghi rõ họ tên)</p>
                    </td>
                    <td>
                        <p><strong>Người bán hàng</strong></p>
                        <p>(Ký, ghi rõ họ tên)</p>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <footer>
            <hr class="separator"/>
            <p><strong>Mã tra cứu hóa đơn:</strong> <span th:text="${maTraCuu}">...</span></p>
            <p>(*) Cần kiểm tra, đối chiếu khi lập, giao, nhận, hóa đơn</p>
        </footer>
    </div>
</body>
</html>