<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.ptudn12.main.controller.CustomerHistoryController"
            prefWidth="1300" prefHeight="700" stylesheets="@customer-management.css">
    
    <padding>
        <Insets top="25" right="30" bottom="25" left="30"/>
    </padding>

    <!-- Top Section -->
    <top>
        <VBox spacing="15">
            <!-- Hàng 1: Sắp xếp lại vị trí các thành phần -->
            <HBox alignment="CENTER_LEFT" spacing="15">
                <Label text="Lịch Sử Mua Vé" styleClass="page-title"/>
                <Label text="Mã KH:" styleClass="field-label-bold">
                    <HBox.margin><Insets left="20"/></HBox.margin>
                </Label>
                <TextField fx:id="maKhField" editable="false" focusTraversable="false" styleClass="info-field" prefWidth="120"/>
                <Label text="Họ Tên:" styleClass="field-label-bold"/>
                <TextField fx:id="hoTenField" editable="false" focusTraversable="false" styleClass="info-field" prefWidth="250"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="Thoát" styleClass="danger-button" onAction="#handleClose"/>
            </HBox>

            <!-- Hàng 2: Sửa lại ColumnConstraints để fix lỗi "3 chấm" -->
            <GridPane hgap="15" vgap="10">
                <Label text="CCCD:" styleClass="field-label-bold" GridPane.columnIndex="0"/>
                <TextField fx:id="cccdField" editable="false" focusTraversable="false" styleClass="info-field" GridPane.columnIndex="1"/>

                <Label text="Hộ chiếu:" styleClass="field-label-bold" GridPane.columnIndex="2"/>
                <TextField fx:id="hoChieuField" editable="false" focusTraversable="false" styleClass="info-field" GridPane.columnIndex="3"/>
                
                <Label text="SĐT:" styleClass="field-label-bold" GridPane.columnIndex="4"/>
                <TextField fx:id="sdtField" editable="false" focusTraversable="false" styleClass="info-field" GridPane.columnIndex="5"/>

                <Label text="Điểm tích:" styleClass="field-label-bold" GridPane.columnIndex="6"/>
                <TextField fx:id="diemTichField" editable="false" focusTraversable="false" styleClass="info-field" GridPane.columnIndex="7"/>

                <!-- Cấu hình độ rộng cột để label không bị co lại -->
                <columnConstraints>
                    <ColumnConstraints minWidth="50" prefWidth="50"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="120"/>
                    <ColumnConstraints minWidth="70" prefWidth="70"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="120"/>
                    <ColumnConstraints minWidth="40" prefWidth="40"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="120"/>
                    <ColumnConstraints minWidth="75" prefWidth="75"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="100"/>
                </columnConstraints>
            </GridPane>
        </VBox>
    </top>

    <!-- Center Section -->
    <center>
        <VBox spacing="15">
            <BorderPane.margin>
                <Insets top="20"/>
            </BorderPane.margin>
            <!-- Gỡ bỏ styleClass="data-table" -->
            <TableView fx:id="historyTable" VBox.vgrow="ALWAYS">
                <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
                <columns>
                    <TableColumn fx:id="sttColumn" text="STT" minWidth="40" maxWidth="50"/>
                    <TableColumn fx:id="ngayMuaColumn" text="Ngày mua vé" minWidth="120"/>
                    <TableColumn fx:id="maVeColumn" text="Mã vé" minWidth="120"/>
                    <TableColumn fx:id="macTauColumn" text="Mác tàu" minWidth="80"/>
                    <TableColumn fx:id="hanhTrinhColumn" text="Hành trình" minWidth="200"/>
                    <TableColumn fx:id="thoiGianColumn" text="Thời gian đi - đến" minWidth="140"/>
                    <TableColumn fx:id="toaColumn" text="Toa - loại chỗ" minWidth="150"/>
                    <TableColumn fx:id="soChoColumn" text="Số chỗ" minWidth="60"/>
                    <TableColumn fx:id="giaVeColumn" text="Giá vé" minWidth="120"/>
                </columns>
            </TableView>

            <!-- Bottom Summary Section -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label fx:id="recordCountLabel" styleClass="field-label-bold"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label text="Tổng tiền:" styleClass="field-label-bold"/>
                <TextField fx:id="totalAmountField" editable="false" focusTraversable="false" styleClass="summary-field" alignment="CENTER_RIGHT" prefWidth="180"/>
            </HBox>
        </VBox>
    </center>
</BorderPane>